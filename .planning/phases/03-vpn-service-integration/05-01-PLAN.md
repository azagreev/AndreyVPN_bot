# Plan 05-01: Monitoring & Status Implementation

## Goal
Implement traffic tracking (MONITOR-01), server status checks (MONITOR-02), and monthly resets (MONITOR-03).

## Tasks
1. [ ] **Database Update**:
    - Add `last_tx`, `last_rx`, `monthly_offset_bytes` to `vpn_profiles` if we want persistence across WG restarts.
    - *Decision*: For simplicity in V1, we will fetch live data and store a "Snapshot" for the monthly reset.
2. [ ] **VPN Service Expansion**:
    - Implement `get_peer_stats(public_key: str)` -> returns bytes.
    - Implement `get_interface_status()` -> returns boolean/string.
3. [ ] **User Monitoring**:
    - Create `/stats` command to show current user's traffic usage.
    - Format bytes to KB/MB/GB.
4. [ ] **Admin Monitoring**:
    - Create `/admin_stats` or update admin menu to show server status and total active users.
5. [ ] **Monthly Reset Logic**:
    - Implement a mechanism to "snapshot" current traffic on the 1st of the month to calculate "Monthly Usage".
6. [ ] **Verification**:
    - Simulate `wg show` output and verify parsing logic.

## Success Criteria
- [ ] User can see their traffic usage via `/stats`.
- [ ] Admin can see if the VPN server is active.
- [ ] Traffic counters correctly "reset" (conceptually) at the start of the month.
